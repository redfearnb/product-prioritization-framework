import React, { useState } from 'react';
import { TrendingUp, Target, DollarSign, Users, Shield, Zap, Plus, X, ChevronDown, ChevronUp } from 'lucide-react';

const ProductPrioritizationFramework = () => {
  const [initiatives, setInitiatives] = useState([
    {
      id: 1,
      name: 'LLM-based Cybersecurity Threat Analysis',
      description: 'AI-powered threat detection system for SOC operations',
      customerValue: 9,
      businessValue: 8,
      technicalFeasibility: 7,
      strategicFit: 9,
      compliance: 10,
      timeToValue: 6,
      expanded: false
    },
    {
      id: 2,
      name: 'Emergency Response Workflow Automation',
      description: 'Mobile-first dispatch and resource allocation system',
      customerValue: 10,
      businessValue: 7,
      technicalFeasibility: 8,
      strategicFit: 8,
      compliance: 9,
      timeToValue: 7,
      expanded: false
    }
  ]);

  const [newInitiative, setNewInitiative] = useState({
    name: '',
    description: '',
    customerValue: 5,
    businessValue: 5,
    technicalFeasibility: 5,
    strategicFit: 5,
    compliance: 5,
    timeToValue: 5
  });

  const [showForm, setShowForm] = useState(false);

  const criteria = [
    { key: 'customerValue', label: 'Customer Value', icon: Users, weight: 0.25, description: 'Impact on end-user outcomes and satisfaction' },
    { key: 'businessValue', label: 'Business Value', icon: DollarSign, weight: 0.20, description: 'Revenue potential, cost savings, or strategic positioning' },
    { key: 'technicalFeasibility', label: 'Technical Feasibility', icon: Zap, weight: 0.15, description: 'Engineering complexity and risk assessment' },
    { key: 'strategicFit', label: 'Strategic Fit', icon: Target, weight: 0.20, description: 'Alignment with portfolio vision and long-term goals' },
    { key: 'compliance', label: 'Compliance/Security', icon: Shield, weight: 0.10, description: 'CMMC, NIST RMF, and regulatory requirements' },
    { key: 'timeToValue', label: 'Time to Value', icon: TrendingUp, weight: 0.10, description: 'Speed to deliver measurable customer outcomes' }
  ];

  const calculateScore = (initiative) => {
    let totalScore = 0;
    criteria.forEach(criterion => {
      totalScore += (initiative[criterion.key] / 10) * criterion.weight * 100;
    });
    return totalScore.toFixed(1);
  };

  const addInitiative = () => {
    if (newInitiative.name && newInitiative.description) {
      setInitiatives([...initiatives, { 
        ...newInitiative, 
        id: Date.now(),
        expanded: false
      }]);
      setNewInitiative({
        name: '',
        description: '',
        customerValue: 5,
        businessValue: 5,
        technicalFeasibility: 5,
        strategicFit: 5,
        compliance: 5,
        timeToValue: 5
      });
      setShowForm(false);
    }
  };

  const deleteInitiative = (id) => {
    setInitiatives(initiatives.filter(i => i.id !== id));
  };

  const toggleExpanded = (id) => {
    setInitiatives(initiatives.map(i => 
      i.id === id ? { ...i, expanded: !i.expanded } : i
    ));
  };

  const sortedInitiatives = [...initiatives].sort((a, b) => 
    parseFloat(calculateScore(b)) - parseFloat(calculateScore(a))
  );

  const getPriorityLevel = (score) => {
    if (score >= 80) return { label: 'Critical Priority', color: '#dc2626', bg: '#fee2e2' };
    if (score >= 65) return { label: 'High Priority', color: '#ea580c', bg: '#ffedd5' };
    if (score >= 50) return { label: 'Medium Priority', color: '#ca8a04', bg: '#fef3c7' };
    return { label: 'Low Priority', color: '#6b7280', bg: '#f3f4f6' };
  };

  return (
    <div style={{ minHeight: '100vh', background: 'linear-gradient(to bottom right, #f8fafc, #e2e8f0)' }}>
      {/* Header */}
      <div style={{ background: 'linear-gradient(to right, #0f172a, #1e293b)', color: 'white', padding: '2rem' }}>
        <div style={{ maxWidth: '1400px', margin: '0 auto' }}>
          <h1 style={{ fontSize: '2.5rem', fontWeight: 'bold', marginBottom: '0.5rem' }}>Strategic Product Prioritization Framework</h1>
          <p style={{ fontSize: '1.125rem', opacity: 0.9, marginBottom: '0.5rem' }}>Multi-criteria decision analysis for complex product portfolios</p>
          <p style={{ fontSize: '0.875rem', opacity: 0.7 }}>Based on 16+ years managing $45M+ portfolios across defense, AI, and enterprise SaaS</p>
          <a href="https://redfearnb.github.io" style={{ display: 'inline-block', marginTop: '1rem', color: 'white', textDecoration: 'none', opacity: 0.8, fontSize: '0.9rem' }}>‚Üê Back to Portfolio</a>
        </div>
      </div>

      {/* Methodology Section */}
      <div style={{ maxWidth: '1400px', margin: '2rem auto', padding: '0 2rem' }}>
        <div style={{ background: 'white', borderRadius: '0.75rem', boxShadow: '0 2px 8px rgba(0,0,0,0.1)', padding: '2rem', marginBottom: '2rem' }}>
          <h2 style={{ fontSize: '1.75rem', fontWeight: 'bold', marginBottom: '1rem', color: '#0f172a' }}>Methodology: Weighted Scoring Model</h2>
          <p style={{ color: '#475569', marginBottom: '1.5rem', lineHeight: '1.7' }}>
            This framework applies weighted multi-criteria decision analysis (MCDA) to evaluate product initiatives across six dimensions critical to government and enterprise contexts. Each criterion is scored 1-10 and weighted based on organizational priorities, producing a composite priority score that guides roadmap sequencing and resource allocation.
          </p>

          <div style={{ background: '#f8fafc', padding: '1.5rem', borderRadius: '0.5rem', border: '1px solid #e2e8f0' }}>
            <h3 style={{ fontWeight: '600', marginBottom: '1rem', color: '#0f172a', fontSize: '1.125rem' }}>Evaluation Criteria & Weights</h3>
            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: '1rem' }}>
              {criteria.map((criterion) => (
                <div key={criterion.key} style={{ display: 'flex', alignItems: 'start', gap: '0.75rem' }}>
                  <div style={{ background: 'white', padding: '0.5rem', borderRadius: '0.375rem', boxShadow: '0 1px 3px rgba(0,0,0,0.1)' }}>
                    <criterion.icon size={20} style={{ color: '#3b82f6' }} />
                  </div>
                  <div style={{ flex: 1 }}>
                    <div style={{ fontWeight: '600', fontSize: '0.875rem', color: '#0f172a', marginBottom: '0.25rem' }}>
                      {criterion.label} ({(criterion.weight * 100).toFixed(0)}%)
                    </div>
                    <div style={{ fontSize: '0.75rem', color: '#64748b' }}>{criterion.description}</div>
                  </div>
                </div>
              ))}
            </div>
          </div>
        </div>

        {/* Add Initiative Button */}
        <div style={{ marginBottom: '2rem' }}>
          <button
            onClick={() => setShowForm(!showForm)}
            style={{
              background: '#3b82f6',
              color: 'white',
              padding: '0.75rem 1.5rem',
              borderRadius: '0.5rem',
              border: 'none',
              fontWeight: '600',
              cursor: 'pointer',
              fontSize: '1rem',
              display: 'flex',
              alignItems: 'center',
              gap: '0.5rem'
            }}
          >
            <Plus size={20} />
            Add Product Initiative
          </button>
        </div>

        {/* Add Initiative Form */}
        {showForm && (
          <div style={{ background: 'white', borderRadius: '0.75rem', boxShadow: '0 2px 8px rgba(0,0,0,0.1)', padding: '2rem', marginBottom: '2rem' }}>
            <h3 style={{ fontSize: '1.5rem', fontWeight: 'bold', marginBottom: '1.5rem', color: '#0f172a' }}>New Product Initiative</h3>
            
            <div style={{ marginBottom: '1.5rem' }}>
              <input
                type="text"
                placeholder="Initiative Name (e.g., 'AI-Powered Threat Detection Platform')"
                value={newInitiative.name}
                onChange={(e) => setNewInitiative({ ...newInitiative, name: e.target.value })}
                style={{ width: '100%', padding: '0.75rem', border: '1px solid #e2e8f0', borderRadius: '0.5rem', fontSize: '1rem' }}
              />
            </div>

            <div style={{ marginBottom: '1.5rem' }}>
              <textarea
                placeholder="Description (e.g., 'Machine learning system for real-time SOC threat analysis and automated response recommendations')"
                value={newInitiative.description}
                onChange={(e) => setNewInitiative({ ...newInitiative, description: e.target.value })}
                style={{ width: '100%', padding: '0.75rem', border: '1px solid #e2e8f0', borderRadius: '0.5rem', fontSize: '1rem', minHeight: '80px' }}
              />
            </div>

            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', gap: '1.5rem', marginBottom: '1.5rem' }}>
              {criteria.map((criterion) => (
                <div key={criterion.key}>
                  <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.5rem' }}>
                    <criterion.icon size={16} style={{ color: '#3b82f6' }} />
                    <label style={{ fontWeight: '600', fontSize: '0.875rem', color: '#0f172a' }}>
                      {criterion.label}: {newInitiative[criterion.key]}/10
                    </label>
                  </div>
                  <input
                    type="range"
                    min="1"
                    max="10"
                    value={newInitiative[criterion.key]}
                    onChange={(e) => setNewInitiative({ ...newInitiative, [criterion.key]: parseInt(e.target.value) })}
                    style={{ width: '100%', height: '6px', borderRadius: '3px', background: '#e2e8f0', cursor: 'pointer' }}
                  />
                </div>
              ))}
            </div>

            <div style={{ display: 'flex', gap: '1rem' }}>
              <button
                onClick={addInitiative}
                style={{
                  background: '#22c55e',
                  color: 'white',
                  padding: '0.75rem 1.5rem',
                  borderRadius: '0.5rem',
                  border: 'none',
                  fontWeight: '600',
                  cursor: 'pointer',
                  fontSize: '1rem'
                }}
              >
                Add to Roadmap
              </button>
              <button
                onClick={() => setShowForm(false)}
                style={{
                  background: '#e2e8f0',
                  color: '#475569',
                  padding: '0.75rem 1.5rem',
                  borderRadius: '0.5rem',
                  border: 'none',
                  fontWeight: '600',
                  cursor: 'pointer',
                  fontSize: '1rem'
                }}
              >
                Cancel
              </button>
            </div>
          </div>
        )}

        {/* Priority Roadmap */}
        <div style={{ background: 'white', borderRadius: '0.75rem', boxShadow: '0 2px 8px rgba(0,0,0,0.1)', padding: '2rem' }}>
          <h2 style={{ fontSize: '1.75rem', fontWeight: 'bold', marginBottom: '1.5rem', color: '#0f172a' }}>
            Prioritized Roadmap ({sortedInitiatives.length} {sortedInitiatives.length === 1 ? 'Initiative' : 'Initiatives'})
          </h2>

          {sortedInitiatives.length === 0 && (
            <div style={{ textAlign: 'center', padding: '3rem', color: '#64748b' }}>
              <Target size={48} style={{ margin: '0 auto 1rem', opacity: 0.3 }} />
              <p style={{ fontSize: '1.125rem', fontWeight: '600' }}>No initiatives yet</p>
              <p style={{ fontSize: '0.875rem' }}>Add your first product initiative to begin prioritization</p>
            </div>
          )}

          <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>
            {sortedInitiatives.map((initiative, index) => {
              const score = calculateScore(initiative);
              const priority = getPriorityLevel(score);
              
              return (
                <div key={initiative.id} style={{ border: '1px solid #e2e8f0', borderRadius: '0.5rem', overflow: 'hidden' }}>
                  <div style={{ background: '#f8fafc', padding: '1.25rem', borderBottom: '1px solid #e2e8f0' }}>
                    <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>
                      <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', flex: 1 }}>
                        <div style={{ 
                          background: 'linear-gradient(135deg, #3b82f6, #2563eb)', 
                          color: 'white', 
                          width: '2.5rem', 
                          height: '2.5rem', 
                          borderRadius: '0.5rem', 
                          display: 'flex', 
                          alignItems: 'center', 
                          justifyContent: 'center', 
                          fontWeight: 'bold',
                          fontSize: '1.125rem'
                        }}>
                          {index + 1}
                        </div>
                        <div style={{ flex: 1 }}>
                          <h3 style={{ fontSize: '1.125rem', fontWeight: 'bold', color: '#0f172a', marginBottom: '0.25rem' }}>
                            {initiative.name}
                          </h3>
                          <p style={{ fontSize: '0.875rem', color: '#64748b' }}>{initiative.description}</p>
                        </div>
                      </div>
                      <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>
                        <div style={{ textAlign: 'right' }}>
                          <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#3b82f6', lineHeight: 1 }}>
                            {score}
                          </div>
                          <div style={{ fontSize: '0.75rem', color: '#64748b', marginTop: '0.25rem' }}>Priority Score</div>
                        </div>
                        <div style={{ 
                          background: priority.bg, 
                          color: priority.color, 
                          padding: '0.5rem 1rem', 
                          borderRadius: '1rem', 
                          fontWeight: '600',
                          fontSize: '0.875rem',
                          whiteSpace: 'nowrap'
                        }}>
                          {priority.label}
                        </div>
                        <button
                          onClick={() => toggleExpanded(initiative.id)}
                          style={{ background: 'none', border: 'none', cursor: 'pointer', padding: '0.5rem' }}
                        >
                          {initiative.expanded ? <ChevronUp size={20} /> : <ChevronDown size={20} />}
                        </button>
                        <button
                          onClick={() => deleteInitiative(initiative.id)}
                          style={{ background: 'none', border: 'none', cursor: 'pointer', color: '#ef4444', padding: '0.5rem' }}
                        >
                          <X size={20} />
                        </button>
                      </div>
                    </div>
                  </div>

                  {initiative.expanded && (
                    <div style={{ padding: '1.5rem', background: 'white' }}>
                      <h4 style={{ fontWeight: '600', marginBottom: '1rem', color: '#0f172a' }}>Detailed Scoring Breakdown</h4>
                      <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem' }}>
                        {criteria.map((criterion) => {
                          const value = initiative[criterion.key];
                          const weightedScore = ((value / 10) * criterion.weight * 100).toFixed(1);
                          
                          return (
                            <div key={criterion.key} style={{ background: '#f8fafc', padding: '1rem', borderRadius: '0.5rem', border: '1px solid #e2e8f0' }}>
                              <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.5rem' }}>
                                <criterion.icon size={16} style={{ color: '#3b82f6' }} />
                                <div style={{ fontSize: '0.75rem', fontWeight: '600', color: '#64748b', textTransform: 'uppercase' }}>
                                  {criterion.label}
                                </div>
                              </div>
                              <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#0f172a', marginBottom: '0.25rem' }}>
                                {value}/10
                              </div>
                              <div style={{ fontSize: '0.75rem', color: '#64748b' }}>
                                Weighted: {weightedScore} pts
                              </div>
                              <div style={{ marginTop: '0.5rem', background: '#e2e8f0', height: '4px', borderRadius: '2px', overflow: 'hidden' }}>
                                <div style={{ 
                                  background: 'linear-gradient(to right, #3b82f6, #2563eb)', 
                                  height: '100%', 
                                  width: `${value * 10}%`,
                                  transition: 'width 0.3s ease'
                                }} />
                              </div>
                            </div>
                          );
                        })}
                      </div>
                    </div>
                  )}
                </div>
              );
            })}
          </div>
        </div>

        {/* Framework Benefits */}
        <div style={{ background: 'linear-gradient(to bottom right, #eff6ff, #dbeafe)', borderRadius: '0.75rem', padding: '2rem', marginTop: '2rem', border: '1px solid #bfdbfe' }}>
          <h3 style={{ fontSize: '1.5rem', fontWeight: 'bold', marginBottom: '1rem', color: '#0f172a' }}>Framework Application & Impact</h3>
          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: '1.5rem' }}>
            <div>
              <h4 style={{ fontWeight: '600', marginBottom: '0.5rem', color: '#1e40af' }}>Government Contracting</h4>
              <p style={{ fontSize: '0.875rem', color: '#475569', lineHeight: '1.6' }}>
                Successfully used to prioritize $45M portfolio across DOE, FEMA, and CASI programs. Compliance weighting ensures CMMC 2.0 and NIST RMF requirements drive roadmap decisions.
              </p>
            </div>
            <div>
              <h4 style={{ fontWeight: '600', marginBottom: '0.5rem', color: '#1e40af' }}>AI/LLM Productization</h4>
              <p style={{ fontSize: '0.875rem', color: '#475569', lineHeight: '1.6' }}>
                Applied to 12 LLM prototype initiatives at Army Cybersecurity Institute, balancing technical feasibility with operational value in high-stakes environments.
              </p>
            </div>
            <div>
              <h4 style={{ fontWeight: '600', marginBottom: '0.5rem', color: '#1e40af' }}>Cross-functional Alignment</h4>
              <p style={{ fontSize: '0.875rem', color: '#475569', lineHeight: '1.6' }}>
                Transparent scoring eliminates political roadmap debates. Used in 30+ executive briefings to secure stakeholder buy-in and resource allocation.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default ProductPrioritizationFramework;
